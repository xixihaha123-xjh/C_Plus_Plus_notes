# 1 线程池

1. 参考文章 

   [基于pthread实现的简单线程池]: https://blog.csdn.net/jcjc918/java/article/details/50395528

   [gRPC 的 C++ 动态线程池源码分析]: http://senlinzhan.github.io/2017/09/09/grpc-dynamic-thread-pool/
   
   
   
   线程池开源库
   
   [libstpool]: https://gitee.com/libstpool/libstpool.git
   
   
   
   



线程池是什么？我的简单理解是有一组预先派生的线程，然后有一个管理员来管理和调度这些线程，你只需不断把需要完成的任务交给他，他就会调度线程的资源来帮你完成。 

那么管理员是怎么做的呢？一种简单的方式就是，管理员管理一个任务的队列，如果收到新的任务，就把任务加到队列尾。每个线程盯着队列，如果队列非空，就去队列头拿一个任务来处理（每个任务只能被一个线程拿到），处理完了就继续去队列取任务。如果没有任务了，线程就休眠，直到任务队列不为空。如果这个管理员更聪明一点，他可能会在没有任务或任务少的时候减少线程的数量，任务处理不过来的时候增加线程的数量，这样就实现了资源的动态管理。

那么任务是什么呢？以后台服务器为例，每一个用户的请求就是一个任务，线程不断的在请求队列里取出请求，完成后继续处理下一个请求。



### 添加任务

添加任务的时候，判断等待线程数，等待线程数为0，就去创建线程，等待线程数不为0，就唤醒一个线程，执行任务。同时释放已经终止的线程。





线程池初始化的时候创建线程池中的线程，初始化时，任务队列为空，线程池中的线程休眠等待



添加任务后，唤醒线程池中的任务